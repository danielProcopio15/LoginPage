<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orçamentos</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .budget-box {
            margin-top: 20px;
        }

        .cost-box {
            margin-bottom: 10px;
            padding: 10px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .cost-box h5 {
            margin: 0;
        }

        .remaining-budget {
            font-size: 18px;
            font-weight: bold;
            color: #28a745;
        }
    </style>
</head>
<body>

    <!-- Botão para voltar ao Dashboard -->
    <a href="dashboard.html" class="btn btn-primary btn-back">← Voltar para o Dashboard</a>

    <div class="container mt-5">
        <h1>Orçamentos</h1>

        <!-- Seção para definir o orçamento total -->
        <div class="budget-box">
            <h4>Defina o orçamento total do mês:</h4>
            <div class="input-group mb-3">
                <span class="input-group-text">R$</span>
                <input type="number" id="total-budget" class="form-control" placeholder="Digite o orçamento total">
                <button class="btn btn-primary" onclick="setTotalBudget()">Definir Orçamento</button>
            </div>
            <p class="remaining-budget">Orçamento restante: R$ <span id="remaining-budget">0.00</span></p>
        </div>

        <!-- Seção para registrar novas demandas financeiras -->
        <div class="new-cost-box">
            <h4>Registrar novas demandas financeiras:</h4>
            <div class="input-group mb-3">
                <input type="text" id="cost-description" class="form-control" placeholder="Descrição da demanda">
                <span class="input-group-text">R$</span>
                <input type="number" id="cost-amount" class="form-control" placeholder="Valor da demanda">
                <button class="btn btn-success" onclick="addNewCost()">Adicionar Demanda</button>
            </div>
        </div>

        <!-- Seção para exibir as demandas registradas -->
        <h4>Demandas registradas:</h4>
        <div id="cost-list"></div>

    </div>

    <!-- Script para manipulação do orçamento -->
    <script>
        let totalBudget = 0;
        let remainingBudget = 0;
        let costList = [];

        // Função para definir o orçamento total
        function setTotalBudget() {
            totalBudget = parseFloat(document.getElementById('total-budget').value);
            if (isNaN(totalBudget) || totalBudget <= 0) {
                alert('Por favor, insira um valor válido para o orçamento total.');
                return;
            }
            remainingBudget = totalBudget;
            updateRemainingBudget();
        }

        // Função para adicionar uma nova demanda financeira
        function addNewCost() {
            const description = document.getElementById('cost-description').value;
            const amount = parseFloat(document.getElementById('cost-amount').value);

            if (!description || isNaN(amount) || amount <= 0) {
                alert('Por favor, insira uma descrição e um valor válido para a demanda.');
                return;
            }

            if (amount > remainingBudget) {
                alert('O valor da demanda excede o orçamento restante.');
                return;
            }

            // Atualizando o orçamento restante
            remainingBudget -= amount;
            updateRemainingBudget();

            // Adicionando a demanda à lista
            costList.push({ description, amount });
            displayCostList();

            // Limpar campos
            document.getElementById('cost-description').value = '';
            document.getElementById('cost-amount').value = '';
        }

        // Função para exibir as demandas na tela
        function displayCostList() {
            const costListDiv = document.getElementById('cost-list');
            costListDiv.innerHTML = ''; // Limpa a lista antes de renderizar novamente

            costList.forEach((cost, index) => {
                const costBox = document.createElement('div');
                costBox.classList.add('cost-box');
                costBox.innerHTML = `
                    <h5>${index + 1}. ${cost.description}</h5>
                    <p>Valor: R$ ${cost.amount.toFixed(2)}</p>
                `;
                costListDiv.appendChild(costBox);
            });
        }

        // Função para atualizar o orçamento restante na tela
        function updateRemainingBudget() {
            document.getElementById('remaining-budget').innerText = remainingBudget.toFixed(2);
        }
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>